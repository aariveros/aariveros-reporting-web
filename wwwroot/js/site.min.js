var reporting={views:{},models:{},loadTemplates:function(e,t){var i=[];$.each(e,function(e,t){reporting[t]?i.push($.get("tpl/"+t+".html",function(e){reporting[t].prototype.template=_.template(e)},"html")):alert(t+" not found")}),$.when.apply(null,i).done(t)}};reporting.Router=Backbone.Router.extend({routes:{"":"home","enterprises/:id":"enterpriseDetails","projects/:id":"projectDetails","employees/:id":"employeeDetails"},initialize:function(){reporting.shellView=new reporting.ShellView,$("body").html(reporting.shellView.render().el),$("body").click(function(){$(".dropdown").removeClass("open")}),this.$content=$("#content")},home:function(){reporting.homelView?(console.log("reusing home view"),reporting.homelView.delegateEvents()):(reporting.homelView=new reporting.HomeView,reporting.homelView.render()),this.$content.html(reporting.homelView.el)},enterpriseDetails:function(e){var t=new reporting.Enterprise({enterpriseId:e}),i=this;t.fetch({success:function(e){console.log(e),i.$content.html(new reporting.EnterpriseView({model:e}).render().el)}})},projectDetails:function(e){var t=new reporting.Project({projectId:e}),i=this;t.fetch({success:function(e){console.log(e),i.$content.html(new reporting.ProjectView({model:e}).render().el)}})},employeeDetails:function(e){var t=new reporting.Employee({employeeId:e}),i=this;t.fetch({success:function(e){console.log(e),i.$content.html(new reporting.EmployeeView({model:e}).render().el)}})}}),$(document).ready(function(){console.log("reusing home view"),reporting.loadTemplates(["HomeView","ShellView","EnterpriseListView","EnterpriseListItemView","EnterpriseView","EnterpriseSummaryView","EnterpriseProjectsView","ProjectListItemView","ProjectView","ProjectSummaryView","EnterpriseEmployeesView","EmployeeListItemView","EmployeeView","EmployeeSummaryView","ReportEnterpriseProjectsEvolutionView","ReportEnterpriseTasksDistributionView","ReportEnterpriseTasksCompletedView","ReportProjectEvolutionView","ReportProjectTasksView","ReportProjectConstraintsView"],function(){reporting.router=new reporting.Router,Backbone.history.start()})}),reporting.urlApi="http://45.79.220.26:5000/",reporting.Enterprise=Backbone.Model.extend({urlRoot:function(){return reporting.urlApi+"enterprises/"},idAttribute:"enterpriseId"}),reporting.EnterpriseCollection=Backbone.Collection.extend({model:reporting.Enterprise,url:reporting.urlApi+"enterprises"}),reporting.Project=Backbone.Model.extend({urlRoot:function(){return reporting.urlApi+"projects/"},idAttribute:"projectId"}),reporting.ProjectCollection=Backbone.Collection.extend({model:reporting.Project,url:reporting.urlApi+"projects"}),reporting.Employee=Backbone.Model.extend({urlRoot:function(){return reporting.urlApi+"employees/"},idAttribute:"employeeId"}),reporting.EmployeeCollection=Backbone.Collection.extend({model:reporting.Employee,url:reporting.urlApi+"employees"}),reporting.EmployeeView=Backbone.View.extend({render:function(){return this.$el.html(this.template(this.model.attributes)),$("#summary",this.el).html(new reporting.EmployeeSummaryView({model:this.model}).render().el),this}}),reporting.EmployeeListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.close,this)},render:function(){return this.$el.html(this.template(this.model.attributes)),this}}),reporting.EmployeeSummaryView=Backbone.View.extend({initialize:function(){this.model.on("change",this.render,this)},render:function(){return this.$el.html(this.template(this.model.attributes)),this}}),reporting.EnterpriseView=Backbone.View.extend({render:function(){this.$el.html(this.template());var e=(this.model.attributes.enterpriseId,new reporting.ProjectCollection(this.model.attributes.projects)),t=new reporting.EmployeeCollection(this.model.attributes.employees);return $("#summary",this.el).html(new reporting.EnterpriseSummaryView({model:this.model}).render().el),$("#projects",this.el).html(new reporting.EnterpriseProjectsView({model:e}).render().el),$("#employees",this.el).html(new reporting.EnterpriseEmployeesView({model:t}).render().el),this}}),reporting.EnterpriseEmployeesView=Backbone.View.extend({tagName:"table",className:"table table-striped",initialize:function(){var e=this;this.model.on("reset",this.render,this),this.model.on("add",function(t){e.$el.append(new reporting.EmployeeListItemView({model:t}).render().el)})},render:function(){return this.$el.empty(),this.$el.html(this.template()),_.each(this.model.models,function(e){this.$el.append(new reporting.EmployeeListItemView({model:e}).render().el)},this),this}}),reporting.EnterpriseListView=Backbone.View.extend({tagName:"table",className:"table table-striped",initialize:function(){var e=this;this.model.on("reset",this.render,this),this.model.on("add",function(t){e.$el.append(new reporting.EnterpriseListItemView({model:t}).render().el)})},render:function(){return this.$el.empty(),this.$el.html(this.template()),_.each(this.model.models,function(e){this.$el.tbody.append(new reporting.EnterpriseListItemView({model:e}).render().el)},this),this}}),reporting.EnterpriseListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.close,this)},render:function(){return this.$el.html(this.template(this.model.attributes)),this}}),reporting.EnterpriseProjectsView=Backbone.View.extend({tagName:"table",className:"table table-striped",initialize:function(){var e=this;this.model.on("reset",this.render,this),this.model.on("add",function(t){e.$el.append(new reporting.ProjectListItemView({model:t}).render().el)})},render:function(){return this.$el.empty(),this.$el.html(this.template()),_.each(this.model.models,function(e){this.$el.append(new reporting.ProjectListItemView({model:e}).render().el)},this),this}}),reporting.EnterpriseSummaryView=Backbone.View.extend({initialize:function(){this.model.on("change",this.render,this)},render:function(){return this.$el.html(this.template(this.model.attributes)),this.$el.append((new reporting.ReportEnterpriseProjectsEvolutionView).render().el),this.$el.append((new reporting.ReportEnterpriseTasksDistributionView).render().el),this.$el.append((new reporting.ReportEnterpriseTasksCompletedView).render().el),this}}),reporting.HomeView=Backbone.View.extend({initialize:function(){var e=new reporting.EnterpriseCollection;e.fetch(),this.enterpriseListView=new reporting.EnterpriseListView({model:e})},events:{"click #showMeBtn":"showMeBtnClick"},render:function(){return this.$el.html(this.template()),$("#hierarchy").html('<li><a href="#">Home</a></li>'),$(".hero-unit",this.el).append(this.enterpriseListView.render().el),this},showMeBtnClick:function(){console.log("showme"),reporting.shellView.search()}}),reporting.ProjectView=Backbone.View.extend({render:function(){this.$el.html(this.template());this.model.attributes.projectId;return $("#summary",this.el).html(new reporting.ProjectSummaryView({model:this.model}).render().el),this}}),reporting.ProjectListItemView=Backbone.View.extend({tagName:"tr",initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.close,this)},render:function(){return this.$el.html(this.template(this.model.attributes)),this}}),reporting.ProjectSummaryView=Backbone.View.extend({initialize:function(){this.model.on("change",this.render,this)},render:function(){return this.$el.html(this.template(this.model.attributes)),this.$el.append((new reporting.ReportProjectEvolutionView).render().el),this.$el.append((new reporting.ReportProjectConstraintsView).render().el),this}}),reporting.ShellView=Backbone.View.extend({initialize:function(){},render:function(){return this.$el.html(this.template()),this}}),reporting.ReportEnterpriseProjectsEvolutionView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){return this.$el.html(this.template()),this}}),reporting.ReportEnterpriseTasksCompletedView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){return this.$el.html(this.template()),this}}),reporting.ReportEnterpriseTasksDistributionView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){return this.$el.html(this.template()),this}}),reporting.ReportProjectConstraintsView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){return this.$el.html(this.template()),this}}),reporting.ReportProjectEvolutionView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){return this.$el.html(this.template()),this}}),reporting.ReportProjectTasksView=Backbone.View.extend({tagName:"div",initialize:function(){},render:function(){return this.$el.html(this.template()),this}});